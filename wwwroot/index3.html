
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netinfo</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>


    <style>
body {
    font-family: 'Nunito', sans-serif;
    background: linear-gradient(135deg, #4D148C, #FF6600);
    min-height: 100vh;
    margin: 0;
    padding: 0;
    color: #fefefe;
    display: flex;
    flex-direction: column;
    align-items: center;
	justify-content: flex-start; /* İçeriği yukarı taşı */
    padding-top: 50px; /* İstenirse ek bir üst boşluk */
}

.container {
    display: flex;
    flex-direction: column;
    align-items: center; /* Kartı yatay olarak ortala */
    padding: 20px;
    margin-top: 10px; /* Üstten ikonların hizasından biraz aşağıda olacak şekilde ayarlayın */
}

.flip-card {
    margin: 0 auto; /* Kartı yatayda ortalamak için */
    width: 80%; /* Daha esnek boyut */
    max-width: 400px; /* Kartın ekranı taşmasını engeller */
    perspective: 1200px; /* 3D perspektif */
}

.flip-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1);
}

.flip-card.admin-active .flip-card-inner {
    transform: rotateY(180deg);
}

.flip-card.admin-active .admin-icon {
    display: none;
}

.flip-card.admin-active .report-icon {
    display: flex;
}

.flip-card-front,
.flip-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 12px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
    border: 2px solid rgba(255, 255, 255, 0.5);
}

.flip-card-front {
    background: rgba(255, 255, 255, 0.2);
    transform: rotateY(0deg);
}

.flip-card-back {
    background: rgba(0, 0, 0, 0.8);
    transform: rotateY(180deg);
}

.info-grid {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
    padding: 10px;
}

.info-card {
    width: 100%; /* Tam genişlik al */
    max-width: 250px; /* Sabit maksimum genişlik */
    height: 100px; /* Sabit yükseklik */
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    padding: 10px;
    text-align: center;
    color: #fff;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    display: flex; /* İçeriği ortala */
    flex-direction: column;
    justify-content: center;
    align-items: center;
}


.info-card i {
    font-size: 1.5rem;
    color: #FFD700;
    margin-bottom: 5px;
}

.info-card p {
    margin: 0;
    font-size: 1rem;
}

.info-card:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
}

.copy-icon {
    position: fixed;
    top: 15px;
    right: 140px; /* Admin ve Switch ikonlarının solunda */
    font-size: 1.5rem;
    background: rgba(123, 0, 0, 0.2); /* Saydam kırmızı arka plan */
    border-radius: 50%;
    padding: 12px;
    color: #FFD700;
    cursor: pointer;
    z-index: 1500; /* Diğer elemanların üstünde */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    transition: background 0.3s ease, transform 0.2s ease;
}

.copy-icon:hover {
    background: rgba(255, 255, 255, 0.4);
    transform: scale(1.1);
}

.admin-icon {
    position: fixed;
    top: 15px;
    right: 80px; /* Switch ikonuyla çakışmaması için sağdan boşluk */
    font-size: 1.5rem;
    background: rgba(123, 0, 0, 0.2); /* Saydam kırmızı arka plan */
    border-radius: 50%;
    padding: 12px;
    color: #FFD700;
    cursor: pointer;
    z-index: 1500; /* Toolbar ve diğer elemanların üstünde */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    transition: background 0.3s ease, transform 0.2s ease;
}

.admin-icon:hover {
    background: rgba(255, 255, 255, 0.4);
    transform: scale(1.1);
}

.switch-icon {
    position: fixed;
    top: 15px;
    right: 20px; /* Admin ikonunun solunda */
    font-size: 1.5rem;
    background: rgba(123, 0, 0, 0.2); /* Saydam kırmızı arka plan */
    border-radius: 50%;
    padding: 12px;
    color: #FFD700;
    cursor: pointer;
    z-index: 1500;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    transition: background 0.3s ease, transform 0.2s ease;
}

.switch-icon:hover {
    background: rgba(255, 255, 255, 0.4);
    transform: scale(1.1);
}

.report-icon {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 1.5rem;
    background: rgba(255, 0, 0, 0.2); /* Saydam kırmızı arka plan */
    border-radius: 50%;
    padding: 12px;
    color: #FFD700;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s ease, background 0.3s ease, color 0.3s ease;
}

.report-icon:hover {
    background: rgba(255, 255, 255, 0.2);
    color: #FFA500;
    transform: scale(1.1);
}

.modal-container {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 300px;
    padding: 20px;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.95);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
    color: #333;
    z-index: 2000;
    text-align: center;
}

.modal-container input {
    width: 90%;
    padding: 12px;
    margin: 10px 0;
    border: 1px solid #ddd;
    border-radius: 8px;
    background: #f9f9f9;
}

.modal-container .close-icon {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 1.5rem;
    color: #FFD700;
    transition: transform 0.3s ease;
}

.modal-container .close-icon:hover {
    transform: scale(1.2);
}

.modal-container .warning-message {
    background: #FFD700;
    border-radius: 5px;
    padding: 10px;
    color: #333;
    margin-top: 10px;
    font-weight: bold;
}

#switchModal {
    display: none; /* Başlangıçta gizli */
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    height: auto;
    background: rgba(0, 0, 0, 0.9);
    color: white;
    z-index: 2000;
    border-radius: 10px;
}

.modal-content {
    padding: 20px;
}

#switchModal .close-icon {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 1.5rem;
    color: #FFD700;
}

#switchDetails {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    overflow-y: auto;
    padding: 10px;
}

#switchDetails img {
    max-width: 100%;
    height: auto;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.modal-container input:focus {
    outline: none;
    border: 2px solid #FF4500;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 0 8px rgba(255, 69, 0, 0.5);
}



.report-panel {
    position: fixed;
    top: 0;
    right: -100%;
    width: 100%;
    max-width: 500px;
    height: 100%;
    background: linear-gradient(135deg, #24292e, #0366d6);
    color: #fefefe;
    padding: 20px;
    box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
    transition: right 0.3s ease-in-out;
    overflow-y: auto;
    z-index: 1100;
}

.report-panel.open {
    right: 0;
}

.report-panel h3 {
    text-align: center;
    font-size: 1.8rem;
    color: #f0db4f;
    margin-bottom: 20px;
}

#reportFilters {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.table {
    background: #fff;
    border-radius: 10px;
    overflow: hidden;
}

#adminModal {
    filter: none;
	background: #fff;
    pointer-events: auto;
    z-index: 2000;
}

.feedback-message {
    position: fixed;
	bottom: calc(60px + 10px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(50, 50, 50, 0.9); /* Uyumlu bir koyu renk */
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    font-size: 1rem;
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.3);
    z-index: 1500;
    animation: feedbackAppear 0.3s ease-out, feedbackDisappear 0.5s ease-in 4.5s; /* Geçiş efektleri */
}

.feedback-message.success {
    background: rgba(34, 139, 34, 0.9); /* Yeşil ton */
}

.feedback-message.error {
    background: rgba(178, 34, 34, 0.9); /* Kırmızı ton */
}

.feedback-message:before {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid rgba(50, 50, 50, 0.9);
}

.feedback-message.success:before {
    border-top-color: rgba(34, 139, 34, 0.9); /* Başarı için */
}

.feedback-message.error:before {
    border-top-color: rgba(178, 34, 34, 0.9); /* Hata için */
}

/* Efekt */
@keyframes feedbackAppear {
    0% {
        opacity: 0;
        transform: translateX(-50%) translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

@keyframes feedbackDisappear {
    0% {
        opacity: 1;
    }
    100% {
        opacity: 0;
    }
}


.feedback-message::after {
    content: '';
    display: block;
    position: absolute;
    bottom: 0;
    left: 0;
    height: 4px;
    background: rgba(255, 255, 255, 0.7);
    animation: progressBar 5s linear forwards;
}

@keyframes progressBar {
    0% {
        width: 100%;
        background-color: rgba(50, 205, 50, 0.9); /* Başlangıç rengi */
    }
    100% {
        width: 0;
        background-color: rgba(255, 69, 0, 0.9); /* Bitim rengi */
    }
}


.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #4D148C, #FF6600);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000;
    animation: fadeOut 1s ease-out 2s forwards;
}



.toolbar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 100;
    visibility: hidden;
    opacity: 0;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(77, 20, 140, 0.9));
    border-top: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.3);
    padding: 8px 0;
    border-radius: 12px 12px 0 0;
    transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out, transform 0.3s ease-in-out;
    transform: translateY(100%);
}

.toolbar.active {
    visibility: visible;
    opacity: 1;
    transform: translateY(0);
}

.toolbar-item {
    flex: 0 1 70px; /* Daha küçük ikonlar için */
    text-align: center;
    font-size: 0.8rem;
    color: #ffffff;
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.3s ease, color 0.3s ease;
    padding: 5px;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.1);
}

.toolbar-item:hover {
    transform: scale(1.1);
    background: rgba(255, 102, 0, 0.8);
    color: #ffffff;
    box-shadow: 0 4px 8px rgba(255, 102, 0, 0.4);
}

.toolbar-item:active {
    transform: scale(0.95);
    background: rgba(255, 102, 0, 0.6);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
}

.toolbar-item i {
    font-size: 1.4rem;
    margin-bottom: 5px;
}

.toolbar-item span {
    font-size: 0.8rem;
}

.status-indicator {
    display: inline-block;
    width: 15px;
    height: 15px;
    border-radius: 50%;
}

.status-online {
    background: #12db22;
}

.status-offline {
    background: #de370d;
}

.fedex-logo {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 100px;
    height: auto;
    filter: drop-shadow(0px 4px 6px rgba(0, 0, 0, 0.5));
    transition: transform 0.3s ease;
}

.fedex-logo:hover {
    transform: scale(1.1);
}

.fullscreen-report {
    visibility: hidden;
    position: fixed;
    top: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #24292e, #0366d6);
    color: #fefefe;
    z-index: 3000; /* Yeterince büyük olduğundan emin olun */
    padding: 20px;
    transition: visibility 0.3s ease-in-out;
}

.fullscreen-report.open {
    visibility: visible;
}

@media (max-width: 768px) {
	.info-grid {
        flex-direction: column; /* Mobilde üst üste sıralama */
        align-items: center; /* Ortala */
    }

    .info-card {
        width: 100%; /* Kartlar tam genişlik alır */
        padding: 15px;
    }
    .toolbar {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: space-around;
    }

    .toolbar-item {
        flex-basis: 45%; /* Her eleman %45 genişlik alır */
        margin-bottom: 10px;
        text-align: center;
    }

    .toolbar-item i {
        display: block;
        font-size: 1.5rem; /* İkon boyutu */
        margin-bottom: 5px;
    }

    .toolbar-item span {
        display: block; /* Metni alt satıra alır */
        font-size: 0.8rem;
    }
}

@media (orientation: landscape) {
    .container {
        flex-direction: row; /* Yatayda kartları yan yana sırala */
        justify-content: space-evenly;
        align-items: center;
    }

    .info-card {
        max-width: 200px; /* Daha küçük kart genişliği */
    }
}



@media (max-width: 480px) {
    .info-grid {
        flex-direction: column; /* Mobilde üst üste sıralama */
        align-items: center; /* Ortala */
    }

    .info-card {
        width: 100%; /* Kartlar tam genişlik alır */
        padding: 15px;
    }
    .toolbar {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: space-around;
    }

    .toolbar-item {
        flex-basis: 45%; /* Her eleman %45 genişlik alır */
        margin-bottom: 10px;
        text-align: center;
    }

    .toolbar-item i {
        display: block;
        font-size: 1.5rem; /* İkon boyutu */
        margin-bottom: 5px;
    }

    .toolbar-item span {
        display: block; /* Metni alt satıra alır */
        font-size: 0.8rem;
    }
}

.rotate-warning {
    position: fixed;
    bottom: calc(120px + 40px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 69, 0, 0.9);
    color: #fff;
    padding: 10px 15px;
    border-radius: 5px;
    font-size: 0.9rem;
    z-index: 9999;
    display: none; /* Varsayılan olarak gizli */
    text-align: center;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.rotate-warning.active {
    display: block; /* Uyarıyı görünür yap */
}




.table-wrapper {
    max-height: 400px;
    overflow-y: auto;
    background: #f4f4f4;
    border-radius: 8px;
    padding: 10px;
}

.custom-table th, .custom-table td {
    color: white; /* Metin rengi */
}

.custom-table tr:nth-child(even) {
    background: #f9f9f9;
}

.custom-table thead {
    background: #4D148C;
    color: white;
}


.custom-table th, .custom-table td {
    color: #333; /* Okunabilir metin rengi */
}

.custom-table td {
    padding: 8px;
}

.custom-table thead {
    background: #4D148C;
    color: white;
}

.custom-table tr:hover {
    background: #FF6600;
    color: white;
}

.filter-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
}

.filter-row {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    justify-content: center;
}

.filter-input, .filter-select {
    padding: 8px;
    font-size: 1rem;
}

.status-up {
    color: lightgreen;
    font-weight: bold;
}

.status-down {
    color: red;
    font-weight: bold;0
}


/* Verisiz durum */
.no-data {
    text-align: center;
    font-size: 1rem;
    color: #999;
    margin: 15px 0;
}

.no-data i {
    font-size: 1.5rem;
    color: #FF6600;
    margin-bottom: 5px;
}

#closeTableIcon {
    position: absolute;
    top: 10px; /* Daha alta taşımak için artırıldı */
    right: 15px; /* Daha sola taşımak için azaltıldı */
    font-size: 2.5rem;
    color: #333333; /* Daha koyu renk (koyu gri) */
    cursor: pointer;
    z-index: 3000; /* Tablo üstünde olmasını sağlar */
    transition: transform 0.2s ease, color 0.2s ease;
}

#closeTableIcon:hover {
    color: #555555; /* Hover sırasında biraz daha açık bir gri */
    transform: scale(1.2); /* Hafif büyütme efekti */
}



/* Close button */
.close-button {
    font-size: 1.2rem;
    color: #FF6600;
    cursor: pointer;
    margin-left: 10px;
    transition: transform 0.3s ease, color 0.3s ease;
}

.close-button:hover {
    color: #FF4500;
    transform: scale(1.2);
}

.report-header {
    text-align: center;
    position: relative;
    margin-bottom: 20px;
    color: #4D148C;
    background: linear-gradient(135deg, #FF6600, #FFD700);
    padding: 10px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.device-name {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.2rem;
    color: #fff;
}

@keyframes shine {
    0% {
        background-position: -200px 0;
    }
    100% {
        background-position: 200px 0;
    }
}

.fade-out {
    animation: fadeOut 1s ease-out forwards;
}

@keyframes fadeOut {
    from {
        opacity: 1;
    }
    to {
        opacity: 0;
    }
}

.interface-card {
    width: 100%;
    max-width: 300px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 15px;
    margin: 10px;
    color: #fff;
    text-align: left;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.interface-card:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.4);
}

.error-message {
    color: red;
    font-weight: bold;
    text-align: center;
}


.interface-card h3 {
    margin: 5px 0;
    font-size: 1.2rem;
}

.interface-card p {
    margin: 5px 0;
    font-size: 1rem;
}

.switch-icon {
    position: fixed;
    top: 15px;
    right: 20px; /* İkonun konumu */
    font-size: 1.5rem;
    background: rgba(123, 0, 0, 0.2);
    border-radius: 50%;
    padding: 12px;
    color: #FFD700;
    cursor: pointer;
    z-index: 1500;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
}

.switch-container {
    background: rgba(255, 255, 255, 0.1); /* Şeffaf beyaz arka plan */
    backdrop-filter: blur(8px); /* Flu efekt */
    border-radius: 10px; /* Köşeleri yuvarlat */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Hafif gölge efekti */
    padding: 20px; /* İçerik boşluğu */
    margin: 20px auto; /* Ortalamak için */
    width: fit-content; /* İçeriğe göre genişlik */
    text-align: center;
}



port-row {
    display: flex;
    justify-content: space-evenly;
    margin: 5px 0;
}

.port {
    width: 40px;
    height: 40px;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 5px;
    font-size: 14px;
    font-weight: bold;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.2s ease;
}

.port.up {
    background-color: #16a085; /* Yeşil */
}

.port.down {
    background-color: #e74c3c; /* Kırmızı */
}

.port.unknown {
    background-color: #95a5a6; /* Gri */
}

.port:hover {
    transform: scale(1.1);
}

.port-details {
    background: rgba(255, 255, 255, 0.95);
    color: #333;
    border-radius: 10px;
    padding: 20px;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    width: 300px;
    z-index: 1000;
    text-align: center;
}



    </style>
</head>
<body>
    
	<!-- Switch İkonu -->


<i class="fas fa-user-shield admin-icon" id="adminIcon" title="Admin Paneli"></i>

<i class="fas fa-copy copy-icon" id="copyIcon" title="Bilgileri Kopyala"></i>


<!-- Modal Overlay -->
<div class="modal-overlay" id="modalOverlay"></div>

<div id="switchIcon" class="switch-icon">
    <i class="fas fa-network-wired"></i> <!-- Ağ ikonu -->
</div>

<div id="switchModal" style="display:none;">
    <div class="modal-content">
        <span class="close-icon" onclick="closeSwitchModal()">&times;</span>
        <div id="switchContainer"></div>
    </div>
</div>

<div id="switchContainer" class="switch-container"></div>



<div id="portDetails" class="port-details" style="display: none;">
    <h3>Port Detayları</h3>
    <div id="portDetailsContent"></div>
    <button class="btn btn-secondary" onclick="closePortDetails()">Kapat</button>
</div>


<div class="container">
        <div id="flipCard" class="flip-card">
            <div class="flip-card-inner">
                <!-- Ön Yüz -->
                <div class="flip-card-front">
                    <h2>Cihaz Bilgileri</h2>
                    <div id="basicDeviceInfo" class="info-grid">
                        <!-- Data kartları buraya gelecek -->
                    </div>
                </div>
                <!-- Arka Yüz -->
                <div class="flip-card-back">
                    <h2>Admin Paneli</h2>
                    <div id="adminDeviceInfo" class="info-grid">
                        <!-- Admin dataları buraya gelecek -->
                    </div>
                </div>
            </div>
        </div>
    </div>




<div class="toolbar" id="toolbar">
    <div id="detailsButton" class="toolbar-item" onclick="toggleDetailsPanel()">
        <i class="fas fa-info-circle"></i>
    </div>
	<div id="interfaceButton" class="toolbar-item" onclick="toggleInterfaceCards()">
    <i class="fas fa-network-wired"></i>
    <span>Interfaces</span>
</div>

    <div id="reportButton" class="toolbar-item" onclick="toggleReportPanel()">
        <i class="fas fa-project-diagram"></i>
    </div>
    <div id="logoutButton" class="toolbar-item" onclick="handleAdminLogout()">
        <i class="fas fa-sign-out-alt"></i>
    </div>
</div>




<div id="rotateWarning" class="rotate-warning">
    Daha iyi bir deneyim için cihazınızı yatay moda çevirin.
</div>



<!-- Yükleme Ekranı -->
<div class="loading-screen">
    <img src="https://tr.eu.fedex.com/fedex_logo.png" alt="FedEx Logo">
</div>


<!-- Tam Ekran Rapor -->
<div class="fullscreen-report" id="fullscreenReport">
	<i class="fas fa-times close-icon" id="closeTableIcon" title="Kapat"></i>
    <div class="report-content" id="reportContent">
        <!-- Tablo içeriği buraya gelecek -->
    </div>
</div>





<!-- Switch Modal -->
<div id="switchModal" class="modal-container" style="display: none;">
    <span class="close-icon" onclick="closeSwitchModal()">&times;</span>
    <h3>Switch Detayları</h3>
    <div id="switchDetails"></div>
</div>

<!-- Admin Modal -->
<div id="adminModal" class="modal-container" style="display: none;">
    <span class="close-icon" onclick="closeAdminModal()">&times;</span>
    <h4>Admin Girişi</h4>
    <input type="password" id="adminPassword" placeholder="Şifreyi Girin">
    <button class="btn btn-primary" onclick="handleAdminLogin()">Giriş Yap</button>
</div>




<!-- Bootstrap and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <!-- Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
    let deviceData = null;
    let loginAttempts = 0;
    let adminTimeout;
    let isLockedOut = false;
	let isAdminLoggedIn = false; // Admin giriş durumu
	let portData = null;
	let deviceModel  = null;
	let areInterfaceCardsVisible = false; // Kart görünürlük durumu
	let ports = []; // Global olarak tanımla
	const ADMIN_TIMEOUT_DURATION = 120000; // Admin oturum süresi (2 dakika)
	const searchInput = document.getElementById('searchInput');
	const statusFilter = document.getElementById('statusFilter');
	
document.getElementById("switchIcon").addEventListener("click", function() {
    const switchModal = document.getElementById("switchModal");
    if (switchModal) {
        switchModal.style.display = "block";
    }
});

document.querySelector("#switchModal .close-icon").addEventListener("click", function() {
    const switchModal = document.getElementById("switchModal");
    if (switchModal) {
        switchModal.style.display = "none";
    }
});

if (!isAdminLoggedIn) {
    console.log("Toolbar is inactive as admin login has not occurred.");
}



if (!searchInput || !statusFilter) {
    console.warn("Arama veya filtreleme alanları bulunamadı. Bu özellik atlanacak.");
} else {
    searchInput.addEventListener('input', filterTable);
    statusFilter.addEventListener('change', filterTable);
}



document.getElementById('copyIcon').addEventListener('click', function () {
    const infoCards = document.querySelectorAll('.info-card');
    if (!infoCards.length) {
        showFeedback("Kopyalanacak bilgi bulunamadı.", false);
        return;
    }

    let textToCopy = Array.from(infoCards)
        .map(card => card.textContent.trim())
        .join('\n'); // Bilgileri birleştir

    navigator.clipboard.writeText(textToCopy)
        .then(() => {
            showFeedback("Bilgiler başarıyla kopyalandı!", true);
        })
        .catch(() => {
            showFeedback("Bilgiler kopyalanamadı.", false);
        });
});





document.addEventListener('DOMContentLoaded', async function () {
    const loadingScreen = document.querySelector('.loading-screen');
    const params = new URLSearchParams(window.location.search);
    const deviceId = params.get('id');
    const basicDeviceInfoDiv = document.getElementById('basicDeviceInfo');
    const reportContentDiv = document.getElementById('reportContent');
const switchIcon = document.getElementById("switchIcon");
console.log(switchIcon); // HTML elementi döndürmelidir.
console.log(window.getComputedStyle(switchIcon).display); // "block" dönerse görünürdür.
console.log(window.getComputedStyle(switchIcon).visibility); // "visible" dönerse görünürdür.
const supportedModels = [
        "C9300-24P",
        "C9300-48P",
        "ISR4351/K9",
        "WS-C3850-48F-E",
        "WS-C3850-24P-S",
        "C9500-24Y4C",
        "C9300L-24T-4G",
        "WS-C2960X-48FPS-L"
    ];
	
	console.log("Device Model:", deviceModel);

    const switchModal = document.getElementById("switchModal");


    // Yükleme ekranını 2 saniye sonra kaldır
    setTimeout(async () => {
        loadingScreen.style.display = 'none';

        if (!deviceId) {
            basicDeviceInfoDiv.textContent = "Cihaz ID'si belirtilmemiş.";
            reportContentDiv.textContent = "Rapor verisi için cihaz ID gerekli.";
            return;
        }


    }, 2000); // 2 saniye bekleme (animasyon süresi)
});

async function fetchDeviceModel(deviceId) {
    try {
        const response = await fetch(`/Netinfo/api/device/get_device_info?id=${deviceId}`);
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        const data = await response.json();
        return data.model; // Assuming the model is part of the device info
    } catch (error) {
        console.error('Error fetching device model:', error);
        return null;
    }
}


async function fetchDeviceData(id) {
        if (!id) {
            console.error("ID is required.");
            return null;
        }

        const url = `/Netinfo/api/device/get_device_info?id=${id}`;
        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return await response.json();
        } catch (error) {
            console.error(`Error fetching device data for ID ${id}: ${error.message}`);
            return null;
        }
    }
	
async function fetchPortData(deviceId) {
    try {
        const response = await fetch(`/Netinfo/api/device/get_device_ports?id=${deviceId}`);
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const portData = await response.json();

        // Veri kontrolü
        if (!portData || !portData.ports || !Array.isArray(portData.ports)) {
            throw new Error("Port bilgileri eksik.");
        }

        return portData.ports;
    } catch (error) {
        console.error("fetchPortData hatası:", error.message);
        return []; // Boş bir dizi döndür
    }
}


	

const switchIcon = document.getElementById("switchIcon");

async function loadInterfaceCards(hostname) {
    try {
        const response = await fetch(`/api/device/get_interfaces?hostname=${hostname}`);
        const result = await response.json();

        if (result.success) {
            const interfaceContainer = document.getElementById("interfaceCards");
            interfaceContainer.innerHTML = ""; // Mevcut kartları temizle

            result.data.forEach(item => {
                const card = document.createElement("div");
                card.className = "interface-card";
                card.innerHTML = `
                    <h3>Arayüz: ${item.Interface}</h3>
                    <p>VLAN ID: ${item.VlanId}</p>
                    <p>VLAN Adı: ${item.VlanName}</p>
                `;
                interfaceContainer.appendChild(card);
            });
        } else {
            console.error("Hata:", result.message);
        }
    } catch (error) {
        console.error("Veri yükleme sırasında hata:", error);
    }
}

function toggleInterfaceCards() {
    const interfaceCardsContainer = document.getElementById("interfaceCards");

    if (!isAdminLoggedIn) {
        showFeedback("Bu özelliği görüntülemek için admin girişi yapmalısınız.", false);
        return;
    }

    if (areInterfaceCardsVisible) {
        interfaceCardsContainer.style.display = "none";
        areInterfaceCardsVisible = false;
    } else {
        interfaceCardsContainer.style.display = "flex"; // Kartları göster
        const hostname = deviceData?.hostname || "TrISTT8sw05"; // Varsayılan veya mevcut hostname
        loadInterfaceCards(hostname); // Kartları yükle
        areInterfaceCardsVisible = true;
    }
}


// Admin giriş durumu değiştiğinde buton görünürlüğünü güncelle
function updateToolbarVisibility() {
    const interfaceButton = document.getElementById("interfaceButton");
    interfaceButton.style.display = isAdminLoggedIn ? "flex" : "none";
}

		
function showFeedback(message, isSuccess) {
    const feedbackContainer = document.createElement("div");
    feedbackContainer.className = `feedback-message ${isSuccess ? "success" : "error"}`;
    feedbackContainer.textContent = message;

    document.body.appendChild(feedbackContainer);

    setTimeout(() => {
        feedbackContainer.remove();
    }, 5000); // 5 saniye sonra mesajı kaldırır
}

document.getElementById("switchIcon").addEventListener("click", openSwitchModal);
document.getElementById("copyIcon").addEventListener("click", copyDeviceInfo);
document.getElementById("adminIcon").addEventListener("click", toggleAdminLogin);
document.getElementById("closeTableIcon").addEventListener("click", function () {
    const fullscreenReport = document.getElementById("fullscreenReport");
    if (fullscreenReport) {
        fullscreenReport.classList.remove("open");
        fullscreenReport.style.visibility = "hidden";
    }
    console.log("Tablo ekranı kapatıldı.");
});

function getDeviceIdFromURL() {
    const params = new URLSearchParams(window.location.search);
    return params.get("id") || null;
}



async function fetchSwitchData(deviceId) {
    try {
        const response = await fetch(`/Netinfo/api/device/get_device_ports?id=${deviceId}`);
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const switchData = await response.json();

        // Veri kontrolü
        if (!switchData || !switchData.ports || !switchData.portCount) {
            throw new Error("Switch verileri eksik veya bozuk.");
        }

        return switchData;
    } catch (error) {
        console.error("Switch verisi alınırken hata:", error.message);
        return null; // Hatalı durumda null döndür
    }
}



async function initializeSwitch() {
    const deviceId = getDeviceIdFromURL();
    if (!deviceId) {
        console.error("Cihaz ID'si alınamadı.");
        return;
    }

    const switchData = await fetchSwitchData(deviceId);

    if (!switchData) {
        console.error("Switch bilgileri yüklenemedi.");
        document.getElementById("switchContainer").innerHTML =
            "<p>Switch verileri yüklenemedi. Lütfen tekrar deneyiniz.</p>";
        return;
    }

    const { ports, deviceModel } = switchData;
    displayPortData(ports, deviceModel);
}

function displayPortData(ports = [], deviceModel) {
    const switchContainer = document.getElementById("switchContainer");
    const portCount = deviceModel?.includes("24") ? 24 : deviceModel?.includes("48") ? 48 : 24;

    if (!ports.length) {
        console.warn("Port bilgileri eksik veya boş");
        switchContainer.innerHTML = `<p>Port bilgisi yüklenemedi.</p>`;
        return;
    }

    let switchHTML = `<h2>${portCount}-Port Switch</h2>`;
    for (let i = 0; i < portCount; i++) {
        const port = ports[i];
        const status = port?.link_status || "unknown";
        switchHTML += `<div class="port ${status}">${i + 1}</div>`;
    }
    switchContainer.innerHTML = switchHTML;
}





document.addEventListener("DOMContentLoaded", initializeSwitch);







function showPortDetails(portData) {
    const portDetails = document.getElementById("portDetails");
    const portDetailsContent = document.getElementById("portDetailsContent");

    if (!portData) {
        portDetailsContent.innerHTML = `<p>Port bilgisi bulunamadı.</p>`;
    } else {
        portDetailsContent.innerHTML = `
            <p><strong>Port No:</strong> ${portData.number || "N/A"}</p>
            <p><strong>Durum:</strong> ${portData.status || "N/A"}</p>
            <p><strong>Açıklama:</strong> ${portData.description || "N/A"}</p>
            <p><strong>MAC Adresi:</strong> ${portData.mac || "N/A"}</p>
            <p><strong>Hız:</strong> ${portData.speed || "N/A"}</p>
        `;
    }

    portDetails.style.display = "block";
}



function closePortDetails() {
    const portDetails = document.getElementById("portDetails");
    if (portDetails) portDetails.style.display = "none";
}




 async function loadDeviceData(id) {
        deviceData = await fetchDeviceData(id);
        if (deviceData) {
            displayBasicDeviceInfo(deviceData);
            displayAdminDeviceInfo(deviceData);
        } else {
            console.error('Cihaz verisi yüklenemedi.');
        }
    }
	
async function loadPortData(deviceId) {
    try {
        const portData = await fetchPortData(deviceId);
        displayPortData(portData);
    } catch (error) {
        console.error('Port verisi yüklenemedi:', error);
        alert('Port verisi yüklenemedi. Lütfen tekrar deneyin.');
    }
}


function showPortDetails(portNumber) {
    if (!ports || ports.length === 0) {
        console.error('Port verisi yüklenmedi');
        return;
    }
    // Port detaylarını göster
}



    // Sayfa yüklendiğinde çalışacak kod
    document.addEventListener('DOMContentLoaded', async () => {
        const urlParams = new URLSearchParams(window.location.search);
        const deviceId = urlParams.get('id');

        if (deviceId) {
            await loadDeviceData(deviceId);
            await loadPortData(deviceId);
        } else {
            console.error('Device ID not provided in URL');
        }
    });


// Tablo filtreleme işlevselliği
function bindTableFilters() {
    const searchInput = document.getElementById('searchInput');
    const statusFilter = document.getElementById('statusFilter');
    const rows = document.querySelectorAll('#reportContent tbody tr');

    function filterTable() {
        const searchText = searchInput.value.toLowerCase();
        const selectedStatus = statusFilter.value.toLowerCase();


        rows.forEach((row, index) => {
            const interfaceText = (row.cells[0]?.textContent || '').toLowerCase().trim();
            const titleText = (row.cells[1]?.textContent || '').toLowerCase().trim();
            const statusText = (row.cells[4]?.textContent || '').toLowerCase().trim(); // Boşluklar temizlendi


            const matchesSearch = interfaceText.includes(searchText) || titleText.includes(searchText);
            const matchesStatus =
                selectedStatus === '' || // Tüm durumlar seçiliyse göster
                (selectedStatus === 'aktif' && statusText === 'aktif') || // Aktif olanları göster
                (selectedStatus === 'pasif' && statusText === 'pasif'); // Pasif olanları göster

            console.log("Eşleşiyor mu?", matchesSearch && matchesStatus);

            row.style.display = matchesSearch && matchesStatus ? '' : 'none';
        });

        console.log("Filtreleme Tamamlandı");
    }

    searchInput.addEventListener('input', filterTable);
    statusFilter.addEventListener('change', filterTable);
}



function checkOrientationAndWarn() {
    const rotateWarning = document.getElementById('rotateWarning');
    if (window.matchMedia("(orientation: portrait)").matches) {
        // Dikey moddaysa uyarıyı göster
        rotateWarning.classList.add('active');
    } else {
        // Yatay moddaysa uyarıyı gizle
        rotateWarning.classList.remove('active');
    }
}

// Ekran yönü değiştiğinde kontrol et
window.addEventListener('resize', checkOrientationAndWarn);
document.addEventListener('DOMContentLoaded', checkOrientationAndWarn);





function displayBasicDeviceInfo(device) {
        const basicDeviceInfoDiv = document.getElementById('basicDeviceInfo');
        basicDeviceInfoDiv.innerHTML = `
            <div class="info-card"><i class="fas fa-server"></i><p><strong>Hostname:</strong> ${device.hostname || 'N/A'}</p></div>
            <div class="info-card"><i class="fas fa-network-wired"></i><p><strong>IP Adresi:</strong> ${device.ipaddress || 'N/A'}</p></div>
            <div class="info-card"><i class="fas fa-signal"></i><p><strong>Durum:</strong> ${device.status || 'N/A'}</p></div>
        `;
    }

function createSwitchVisual(portCount, ports) {
    const switchContainer = document.getElementById("switchContainer");
    switchContainer.innerHTML = ""; // Mevcut içeriği temizle

    for (let i = 0; i < Math.ceil(portCount / 12); i++) {
        const row = document.createElement("div");
        row.className = "port-row";

        for (let j = 0; j < 12; j++) {
            const portNumber = i * 12 + j + 1;
            if (portNumber > portCount) break;

            const port = ports.find(p => p.number === portNumber);
            const portDiv = document.createElement("div");
            portDiv.className = `port ${port?.status || "unknown"}`;
            portDiv.textContent = portNumber;

            portDiv.addEventListener("click", () => showPortDetails(port || { number: portNumber }));
            row.appendChild(portDiv);
        }

        switchContainer.appendChild(row);
    }
}



function closeSwitchModal() {
    const switchModal = document.getElementById("switchModal");
    if (switchModal) switchModal.style.display = "none";
}




function closeAdminModal() {
    const modal = document.getElementById('adminModal');
    modal.style.display = 'none';
    modal.removeAttribute('data-target'); // Hedef bilgiyi sıfırla
}

function openSwitchModal() {
    const switchModal = document.getElementById('switchModal');
    
    // Switch görselini oluştur
    displaySwitchVisual();

    switchModal.style.display = 'block'; // Modali göster
}

function displaySwitchVisual() {
    const switchContainer = document.getElementById("switchContainer");
    if (!switchContainer) {
        console.error("Switch görseli için container bulunamadı.");
        return;
    }

    switchContainer.innerHTML = "<p>Switch görseli burada gösterilecektir.</p>";
}




    function flipCard() {
        document.getElementById("flipCard").classList.toggle("admin-active");
        document.getElementById("fetchReportButton").classList.toggle("d-block");
    }
	
function toggleDetailsPanel() {
    const flipCard = document.getElementById("flipCard");

    if (isAdminLoggedIn) {
        if (flipCard.classList.contains("admin-active")) {
            // Admin paneli açıkken tekrar basılırsa basic info ekranına dön
            flipCard.classList.remove("admin-active"); 
            displayBasicDeviceInfo(); // Temel cihaz bilgilerini göster
        } else {
            // Admin panelini aç
            flipCard.classList.add("admin-active");
            displayAdminDeviceInfo(); // Admin detaylarını yükle
            showToolbar(); // Toolbar'ı göster
        }
    } else {
        // Admin giriş yapılmamışsa temel bilgi ekranını yükle
        showFeedback("Admin oturumu başlatılmamış. Giriş yapmalısınız.", false);
        displayBasicDeviceInfo(); // Temel cihaz bilgilerini göster
    }
}

	
	
function toggleReportPanel() {
    if (isAdminLoggedIn) {
        const reportPanel = document.getElementById('fullscreenReport');
        if (!reportPanel) {
            console.error("Rapor paneli öğesi bulunamadı.");
            return;
        }
        if (reportPanel.classList.contains('open')) {
            reportPanel.classList.remove('open');
            reportPanel.style.visibility = 'hidden';
			console.log("Panel visibility:", document.getElementById('fullscreenReport').classList);

        } else {
            reportPanel.classList.add('open');
            reportPanel.style.visibility = 'visible';
			console.log("Panel visibility:", document.getElementById('fullscreenReport').classList);

        }
    } else {
        showFeedback("Admin oturumu başlatılmamış. Giriş yapmalısınız.", false);
    }
}





function logAdminActivity(type, message) {
    fetch('/Netinfo/api/log/admin_activity', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            activity: type,
            message: message,
            timestamp: new Date().toISOString(),
        }),
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(err => {
                console.error("Log gönderim hatası:", err);
            });
        }
        console.log("Log başarıyla kaydedildi.");
    })
    .catch(err => console.error("Log gönderim sırasında hata oluştu:", err));
}

function showToolbar() {
    const toolbar = document.getElementById('toolbar');
    if (toolbar) {
        toolbar.classList.add('active');
        toolbar.style.visibility = 'visible';
        toolbar.style.opacity = '1';
    }
}

function hideToolbar() {
    const toolbar = document.getElementById('toolbar');
    if (toolbar) {
        toolbar.classList.remove('active');
        toolbar.style.visibility = 'hidden';
        toolbar.style.opacity = '0';
    }
}



function toggleAdminLogin() {
    const adminModal = document.getElementById("adminModal");
    if (!adminModal) {
        console.error("Admin modal öğesi bulunamadı.");
        return;
    }
    adminModal.style.display = "block"; // Modalı göster
    console.log("Admin modal açıldı.");
}




document.addEventListener("DOMContentLoaded", () => {
    if (isAdminLoggedIn) {
        showToolbar();
    } else {
        hideToolbar();
    }
});


function checkToolbarState() {
    const toolbar = document.getElementById("toolbar");
    if (toolbar) {
        const toolbarStyle = window.getComputedStyle(toolbar);
        log(`Toolbar durumu - Display: ${toolbarStyle.display}, Opacity: ${toolbarStyle.opacity}`);
    } else {
        log("Toolbar öğesi bulunamadı.", "error");
    }
}


function setAdminLoggedIn(status) {
    isAdminLoggedIn = status;
    log(`isAdminLoggedIn durumu değişti: ${status}`);
}





function closeReportPanel() {
    const fullscreenReport = document.getElementById('fullscreenReport');
    fullscreenReport.classList.remove('open');
    setTimeout(() => {
        fullscreenReport.style.visibility = 'hidden';
    }, 500); // Animasyon süresi ile uyumlu
}
// Ölçeklendirme fonksiyonu
function adjustForMobileView() {
    const isMobile = window.matchMedia("(max-width: 768px)").matches;
    const flipCard = document.querySelector('.flip-card');
    const fullscreenReport = document.getElementById('fullscreenReport');

    if (isMobile) {
        // Kart ve rapor daha küçük hale gelsin
        flipCard.style.transform = "scale(0.8)";
        fullscreenReport.style.transform = "scale(0.9)";
    } else {
        // Masaüstü için varsayılan boyut
        flipCard.style.transform = "scale(1)";
        fullscreenReport.style.transform = "scale(1)";
    }
}

// Ekran boyutu değiştiğinde kontrol et
window.addEventListener('resize', adjustForMobileView);
document.addEventListener('DOMContentLoaded', adjustForMobileView);



 function displayAdminDeviceInfo(device) {
        const adminDeviceInfoDiv = document.getElementById('adminDeviceInfo');
        adminDeviceInfoDiv.innerHTML = `
            <div class="info-card"><i class="fas fa-server"></i><p><strong>Hostname:</strong> ${device.hostname || 'N/A'}</p></div>
            <div class="info-card"><i class="fas fa-network-wired"></i><p><strong>IP Adresi:</strong> ${device.ipaddress || 'N/A'}</p></div>
            <div class="info-card"><i class="fas fa-barcode"></i><p><strong>Seri No:</strong> ${device.serial || 'N/A'}</p></div>
            <div class="info-card"><i class="fas fa-microchip"></i><p><strong>Model:</strong> ${device.model || 'N/A'}</p></div>
            <div class="info-card"><i class="fas fa-signal"></i><p><strong>Durum:</strong> ${device.status || 'N/A'}</p></div>
        `;
    }





// Alan adlarını kullanıcı dostu hale getirir
function formatFieldName(fieldName) {
    return fieldName
        .replace(/_/g, ' ') // Alt çizgileri boşlukla değiştir
        .replace(/\b\w/g, char => char.toUpperCase()); // Her kelimenin baş harfini büyük yap
}

async function fetchAdminInfo() {
    try {
        const response = await fetch('/Netinfo/api/device/get_admin_info');
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }
        const adminData = await response.json();
        console.log("Admin API Yanıtı:", adminData); // Burada gelen veriyi kontrol edin
        deviceData = adminData;
        displayAdminDeviceInfo();
        console.log("Admin verileri (deviceData):", deviceData);

    } catch (error) {
        console.error("Admin bilgileri yüklenirken hata:", error.message);
    }
} // Eksik kapanış buraya eklendi!





async function checkAdminPassword() {
    const passwordInput = document.getElementById('adminPassword');
    if (!passwordInput) {
        console.error("adminPassword öğesi bulunamadı.");
        showFeedback("Şifre alanı eksik. Lütfen yeniden yükleyin.", false);
        return;
    }

    const passwordValue = passwordInput.value;
    if (!passwordValue) {
        showFeedback("Şifre alanı boş bırakılamaz.", false);
        return;
    }

    try {
        const response = await fetch('/Netinfo/api/environment/validate_admin_password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ password: passwordValue }),
        });

        if (!response.ok) {
            const errorText = await response.text();
            throw new Error(`Sunucu hatası: ${response.status}, Detay: ${errorText}`);
        }

        const result = await response.json();
        console.log("Backend'den gelen cevap:", result);

        if (result.success) {
            handleSuccessfulAdminLogin(); // Şifre doğruysa admin oturum başlat
        } else {
            handleFailedAdminLogin(); // Şifre yanlışsa hata işlemi
        }
    } catch (error) {
        console.error("Şifre doğrulama sırasında bir hata oluştu:", error.message);
        showFeedback("Bir hata oluştu: " + error.message, false);
    }
}


const toolbar = document.getElementById("toolbar");

// Toolbar'ın doğru şekilde çalışıp çalışmadığını kontrol etmek için
console.log("Toolbar sınıf listesi:", toolbar.classList);
console.log("Toolbar CSS durumu:", window.getComputedStyle(toolbar).display);

const flipCardInner = document.querySelector('.flip-card-inner');
console.log(window.getComputedStyle(flipCardInner).transform); // "matrix(...)" bekleniyor



// Admin giriş/çıkış fonksiyonlarına görünürlük güncellemeyi ekleyelim
function handleSuccessfulAdminLogin() {
    isAdminLoggedIn = true;
    showToolbar();
    showFeedback("Admin girişi başarılı!", true);
    updateToolbarVisibility();
}





function handleFailedAdminLogin() {
    loginAttempts++;
    const passwordInput = document.getElementById('adminPassword');
    if (passwordInput) passwordInput.value = ""; // Şifre alanını temizle

    const feedbackMessage = loginAttempts >= 3
        ? "Çok fazla hatalı giriş yaptınız. 10 dakika bekleyin."
        : "Hatalı şifre, lütfen tekrar deneyiniz.";

    showFeedback(feedbackMessage, false);

    if (loginAttempts >= 3) {
        isLockedOut = true;
        setTimeout(() => {
            isLockedOut = false;
            loginAttempts = 0;
            showFeedback("Hatalı giriş süresi doldu. Yeniden deneyebilirsiniz.", true);
        }, 600000); // 10 dakika
    }
}

async function handleAdminLogin() {
    const passwordInput = document.getElementById('adminPassword');
    if (!passwordInput) {
        console.error("Şifre girişi alanı bulunamadı.");
        showFeedback("Bir hata oluştu. Lütfen yeniden deneyin.", false);
        return;
    }

    const password = passwordInput.value;
    if (!password) {
        showFeedback("Şifre alanı boş bırakılamaz.", false);
        return;
    }
	
	console.log(JSON.stringify({ password })); // Gönderilen veriyi kontrol edin


    try {
        const response = await fetch('/Netinfo/api/environment/validate_admin_password', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ password }),
});


        const result = await response.json();
        if (result.success) {
            isAdminLoggedIn = true; // Giriş durumunu güncelle
            showToolbar(); // Toolbar'ı görünür yap
            document.getElementById('adminModal').style.display = 'none'; // Modalı kapat
            showFeedback("Admin oturumu başladı!", true);
        } else {
            showFeedback("Hatalı şifre, tekrar deneyiniz.", false);
        }
    } catch (error) {
        console.error("Şifre doğrulama hatası:", error.message);
        showFeedback("Bir hata oluştu: " + error.message, false);
    }
}

document.addEventListener("DOMContentLoaded", () => {
    updateToolbarVisibility();
});


function handleAdminLogout() {
    isAdminLoggedIn = false;
    hideToolbar();
    updateToolbarVisibility();
    areInterfaceCardsVisible = false;
    const interfaceCardsContainer = document.getElementById("interfaceCards");
    interfaceCardsContainer.style.display = "none"; // Kartları gizle
    showFeedback("Admin oturumu sona erdi.", true);
}



function showAdminModal() {
    if (isAdminLoggedIn) {
		showToolbar(); // Toolbar'ı aktif yap
        toggleDetailsPanel(); // Eğer admin girişi varsa direkt detayları göster
    } else {
        const adminModal = document.getElementById('adminModal');
        adminModal.style.display = 'block'; // Şifre ekranını göster
    }
}




function startAdminTimeout() {
    clearTimeout(adminTimeout);
    adminTimeout = setTimeout(() => {
        isAdminLoggedIn = false; // Oturumu kapat
        showFeedback("Admin oturum süresi sona erdi. Yeniden giriş yapmalısınız.", false);
    }, ADMIN_TIMEOUT_DURATION); // Timeout süresi
}



function showTimeoutWarning() {
    const warning = document.createElement("div");
    warning.className = "feedback-message error";
    warning.textContent = "Admin oturum süresi doldu. Yeniden giriş yapmalısınız.";
    document.body.appendChild(warning);

    setTimeout(() => warning.remove(), 5000); // Mesaj 5 saniye görünür
}




function handleEnterKey(event) {
        if (event.key === "Enter") {
            checkAdminPassword();
        }
    }
	
function copyDeviceInfo() {
    const flipCard = document.getElementById("flipCard");
    const isAdminActive = flipCard.classList.contains("admin-active");

    // Aktif yüze göre doğru bilgiyi seç
    const elementId = isAdminActive ? "adminDeviceInfo" : "basicDeviceInfo";
    const infoElement = document.getElementById(elementId);

    if (!infoElement || !infoElement.children.length) {
        showFeedback("Kopyalanacak bilgi bulunamadı.", false);
        return;
    }

    let textToCopy = Array.from(infoElement.querySelectorAll(".info-card"))
        .map(card => card.textContent.trim())
        .join("\n");

    navigator.clipboard.writeText(textToCopy)
        .then(() => {
            showFeedback("Bilgiler başarıyla kopyalandı!", true);
        })
        .catch(() => {
            showFeedback("Bilgiler kopyalanamadı.", false);
        });
}

</script>


</body>
</html>
